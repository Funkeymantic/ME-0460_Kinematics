close all; clc;

% ============================================================
% Part 6 Plot: Degrees vs Time (All 4 servos)
% Using pasted Arduino data: [t_ms, theta_deg, us1, us2, us3, us4]
% ============================================================

data = [
360	144.29	2177	2076	2117	1778
380	145.79	2194	2093	2133	1796
400	147.06	2208	2107	2147	1812
420	148.11	2220	2119	2158	1825
440	148.94	2230	2128	2167	1835
460	149.53	2236	2134	2174	1842
480	149.88	2240	2138	2177	1847
500	150.00	2242	2140	2179	1848
520	149.88	2240	2138	2177	1847
540	149.53	2236	2134	2174	1842
560	148.94	2230	2128	2167	1835
580	148.11	2220	2119	2158	1825
600	147.06	2208	2107	2147	1812
620	145.79	2194	2093	2133	1796
640	144.29	2177	2076	2117	1778
660	142.58	2157	2057	2098	1757
680	140.66	2135	2036	2077	1733
700	138.54	2111	2012	2054	1707
720	136.23	2085	1987	2029	1678
740	133.74	2056	1959	2002	1648
760	131.07	2026	1929	1973	1615
780	128.25	1994	1898	1943	1580
800	125.27	1960	1865	1910	1543
820	122.15	1924	1830	1877	1505
840	118.91	1887	1794	1841	1465
860	115.55	1849	1757	1805	1423
880	112.09	1809	1718	1767	1381
900	108.54	1769	1679	1729	1337
920	104.92	1728	1639	1690	1292
940	101.24	1686	1598	1650	1247
960	97.52	1643	1557	1609	1201
980	93.77	1600	1515	1569	1155
1000	90.00	1558	1473	1528	1108
1020	86.23	1515	1431	1487	1062
1040	82.48	1472	1389	1446	1016
1060	78.76	1429	1348	1406	970
1080	75.08	1387	1307	1366	924
1100	71.46	1346	1267	1327	880
1120	67.91	1306	1228	1288	836
1140	64.45	1266	1189	1251	793
1160	61.09	1228	1152	1214	752
1180	57.85	1191	1116	1179	712
1200	54.73	1155	1081	1145	674
1220	51.75	1121	1048	1113	637
1240	48.93	1089	1017	1082	602
1260	46.26	1059	987	1053	569
1280	43.77	1030	959	1026	538
1300	41.46	1004	934	1001	510
1320	39.34	980		910	978	500
1340	37.42	958		889	957	500
1360	35.71	938		870	939	500
1380	34.21	921		853	923	500
1400	32.94	907		839	909	500
1420	31.89	895		827	897	500
1440	31.06	885		818	888	500
1460	30.47	879		812	882	500
1480	30.12	875		808	878	500
1500	30.00	873		806	877	500
1520	30.12	875		808	878	500
1540	30.47	879		812	882	500
1560	31.06	885		818	888	500
1580	31.89	895		827	897	500
1600	32.94	907		839	909	500
1620	34.21	921		853	923	500
1640	35.71	938		870	939	500
1660	37.42	958		889	957	500
1680	39.34	980		910	978	500
1700	41.46	1004	934	1001	510
1720	43.77	1030	959	1026	538
1740	46.26	1059	987	1053	569
1760	48.93	1089	1017	1082	602
1780	51.75	1121	1048	1113	637
1800	54.73	1155	1081	1145	674
1820	57.85	1191	1116	1179	712
1840	61.09	1228	1152	1214	752
1860	64.45	1266	1189	1251	793
1880	67.91	1306	1228	1288	836
1900	71.46	1346	1267	1327	880
1920	75.08	1387	1307	1366	924
1940	78.76	1429	1348	1406	970
1960	82.48	1472	1389	1446	1016
1980	86.23	1515	1431	1487	1062
2000	90.00	1558	1473	1528	1108
2020	93.77	1600	1515	1569	1155
2040	97.52	1643	1557	1609	1201
2060	101.24	1686	1598	1650	1247
2080	104.92	1728	1639	1690	1292
2100	108.54	1769	1679	1729	1337
2120	112.09	1809	1718	1767	1381
2140	115.55	1849	1757	1805	1423
2160	118.91	1887	1794	1841	1465
2180	122.15	1924	1830	1877	1505
2200	125.27	1960	1865	1910	1543
2220	128.25	1994	1898	1943	1580
2240	131.07	2026	1929	1973	1615
2260	133.74	2056	1959	2002	1648
2280	136.23	2085	1987	2029	1678
2300	138.54	2111	2012	2054	1707
2320	140.66	2135	2036	2077	1733
2340	142.58	2157	2057	2098	1757
2360	144.29	2177	2076	2117	1778
2380	145.79	2194	2093	2133	1796
2400	147.06	2208	2107	2147	1812
2420	148.11	2220	2119	2158	1825
2440	148.94	2230	2128	2167	1835
2460	149.53	2236	2134	2174	1842
2480	149.88	2240	2138	2177	1847
2500	150.00	2242	2140	2179	1848
2520	149.88	2240	2138	2177	1847
2540	149.53	2236	2134	2174	1842
2560	148.94	2230	2128	2167	1835
2580	148.11	2220	2119	2158	1825
2600	147.06	2208	2107	2147	1812
2620	145.79	2194	2093	2133	1796
2640	144.29	2177	2076	2117	1778
2660	142.58	2157	2057	2098	1757
2680	140.66	2135	2036	2077	1733
2700	138.54	2111	2012	2054	1707
2720	136.23	2085	1987	2029	1678
2740	133.74	2056	1959	2002	1648
2760	131.07	2026	1929	1973	1615
2780	128.25	1994	1898	1943	1580
2800	125.27	1960	1865	1910	1543
2820	122.15	1924	1830	1877	1505
2840	118.91	1887	1794	1841	1465
2860	115.55	1849	1757	1805	1423
2880	112.09	1809	1718	1767	1381
2900	108.54	1769	1679	1729	1337
2920	104.92	1728	1639	1690	1292
2940	101.24	1686	1598	1650	1247
2960	97.52	1643	1557	1609	1201
2980	93.77	1600	1515	1569	1155
3000	90.00	1558	1473	1528	1108
3020	86.23	1515	1431	1487	1062
3040	82.48	1472	1389	1446	1016
3060	78.76	1429	1348	1406	970
3080	75.08	1387	1307	1366	924
3100	71.46	1346	1267	1327	880
3120	67.91	1306	1228	1288	836
3140	64.45	1266	1189	1251	793
3160	61.09	1228	1152	1214	752
3180	57.85	1191	1116	1179	712
3200	54.73	1155	1081	1145	674
3220	51.75	1121	1048	1113	637
3240	48.93	1089	1017	1082	602
3260	46.26	1059	987		1053	569
3280	43.77	1030	959		1026	538
3300	41.46	1004	934		1001	510
3320	39.34	980		910		978		500
3340	37.42	958		889		957		500
3360	35.71	938		870		939		500
3380	34.21	921		853		923		500
3400	32.94	907		839		909		500
3420	31.89	895		827		897		500
3440	31.06	885		818		888		500
3460	30.47	879		812		882		500
3480	30.12	875		808		878		500
3500	30.00	873		806		877		500
3520	30.12	875		808		878		500
3540	30.47	879		812		882		v500
3560	31.06	885		818		888		500
3580	31.89	895		827		897		500
3600	32.94	907		839		909		500
3620	34.21	921		853		923		500
3640	35.71	938		870		939		500
3660	37.42	958		889		957		500
3680	39.34	980		910		978		500
3700	41.46	1004	934		1001	510
3720	43.77	1030	959		1026	538
3740	46.26	1059	987		1053	569
3760	48.93	1089	1017	1082	602
3780	51.75	1121	1048	1113	637
3800	54.73	1155	1081	1145	674
3820	57.85	1191	1116	1179	712
3840	61.09	1228	1152	1214	752
3860	64.45	1266	1189	1251	793
3880	67.91	1306	1228	1288	836
3900	71.46	1346	1267	1327	880
3920	75.08	1387	1307	1366	924
3940	78.76	1429	1348	1406	970
3960	82.48	1472	1389	1446	1016
3980	86.23	1515	1431	1487	1062
4000	90.00	1558	1473	1528	1108
];

% columns
t = data(:,1)/1000;  % seconds
us1 = data(:,3);
us2 = data(:,4);
us3 = data(:,5);
us4 = data(:,6);

% Calibration equations (us = m*theta + b), invert to get theta
m1 = 11.4033; b1 = 531.24;
m2 = 11.1111; b2 = 473.00;
m3 = 10.8484; b3 = 551.44;
m4 = 12.3308; b4 = -1.40;

theta1 = (us1 - b1)/m1;
theta2 = (us2 - b2)/m2;
theta3 = (us3 - b3)/m3;
theta4 = (us4 - b4)/m4;

% Plot (degrees vs time)
figure(1); clf; hold on; grid on;
plot(t, theta1, 'r-', 'LineWidth', 2);
plot(t, theta2, 'g-', 'LineWidth', 2);
plot(t, theta3, 'b-', 'LineWidth', 2);
plot(t, theta4, 'k-', 'LineWidth', 2);

title('Sinusoidal Test: Angle vs Time (All 4 Servos)');
xlabel('Time (s)');
ylabel('Angle (deg)');
legend({'Servo 1','Servo 2','Servo 3','Servo 4'}, 'Location', 'best');

% Save for submission
saveas(gcf, 'RobotA_Lastname_TestingPlot.png');
print(gcf, 'RobotA_Lastname_TestingPlot', '-dpdf', '-bestfit');
